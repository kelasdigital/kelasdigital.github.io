// Ganti fungsi load materi lama Anda dengan ini agar terhubung ke Firebase materi
async function fetchMateriSiswa() {
    const container = document.getElementById('materiList');
    try {
        const q = query(collection(db, "materi"), orderBy("createdAt", "desc"));
        const snap = await getDocs(q);
        
        let html = "";
        snap.forEach(doc => {
            const d = doc.data();
            html += `
                <div class="materi-card" onclick="viewMateri('${d.link}')" style="background:rgba(255,255,255,0.05); padding:15px; border-radius:10px; margin-bottom:10px; cursor:pointer;">
                    <div style="font-weight:bold;">${d.judul}</div>
                    <div style="font-size:11px; color:var(--accent-neon);">${d.jenjang}</div>
                </div>`;
        });
        container.innerHTML = html || "<p>Belum ada materi.</p>";
    } catch (e) { container.innerHTML = "<p>Gagal memuat materi.</p>"; }
}

// Fungsi Preview Iframe Siswa
window.viewMateri = (url) => {
    const preview = document.getElementById('materiPreview');
    const viewerUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(url)}&embedded=true`;
    preview.innerHTML = `<iframe src="${viewerUrl}" style="width:100%; height:100%; border:none; background:white;"></iframe>`;
};