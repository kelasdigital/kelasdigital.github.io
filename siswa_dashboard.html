// --- LOGIKA LOAD MATERI UNTUK SISWA.HTML ---
async function loadMateriSiswa() {
    const listContainer = document.getElementById('materiList');
    try {
        const q = query(collection(db, "materi"), orderBy("createdAt", "desc"));
        const snap = await getDocs(q);
        
        let html = "";
        snap.forEach((doc) => {
            const d = doc.data();
            // Pembedaan Ikon tanpa merubah tampilan kartu
            const icon = (d.format === "video") 
                ? '<i class="fa-brands fa-youtube" style="color:#ff0000; font-size:1.4rem;"></i>' 
                : '<i class="fa-solid fa-file-pdf" style="color:var(--accent-neon); font-size:1.4rem;"></i>';

            html += `
                <div class="materi-card" onclick="viewMateri('${d.link}', '${d.format}')">
                    <div style="display:flex; align-items:center; gap:12px;">
                        ${icon}
                        <div>
                            <div style="font-size:14px; font-weight:700;">${d.judul}</div>
                            <div style="font-size:11px; color:var(--accent-neon);">${d.jenjang}</div>
                        </div>
                    </div>
                </div>`;
        });
        listContainer.innerHTML = html || "<p>Belum ada materi.</p>";
    } catch (e) { console.error(e); }
}

// --- LOGIKA VIEW MATERI UNTUK SISWA.HTML ---
window.viewMateri = (url, format) => {
    const preview = document.getElementById('materiPreview');
    preview.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i>`;
    
    // Jika format video, tampilkan langsung link YouTube Embed
    const finalUrl = (format === "video") 
        ? url 
        : `https://docs.google.com/viewer?url=${encodeURIComponent(url)}&embedded=true`;

    setTimeout(() => {
        preview.innerHTML = `<iframe src="${finalUrl}" style="width:100%; height:100%; border:none; background:white;" allowfullscreen></iframe>`;
    }, 500);
};
