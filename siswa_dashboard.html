<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siswa - KELAS DIGITAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --p-blue: #1a73e8; --bg: #f8f9fa; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); padding: 20px; }
        .container { max-width: 900px; margin: auto; }
        .header { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: white; border-radius: 20px; cursor: pointer; font-weight: 600; font-size: 14px; border: 1px solid #ddd; }
        .tab.active { background: var(--p-blue); color: white; border-color: var(--p-blue); }
        
        .materi-card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; border-left: 5px solid var(--p-blue); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .materi-card h3 { color: #333; margin-bottom: 5px; }
        .materi-card p { color: #666; font-size: 14px; line-height: 1.5; }
        .materi-card .meta { font-size: 11px; color: #999; margin-top: 10px; }
        .content-area { display: none; }
        .content-area.active { display: block; }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h2>üè† Dashboard Siswa</h2>
            <select id="filter-jenjang" style="padding: 5px 10px; border-radius: 5px;">
                <option value="SMA">Jenjang: SMA</option>
                <option value="MTs">Jenjang: MTs</option>
                <option value="MI">Jenjang: MI</option>
            </select>
        </div>

        <div class="nav-tabs">
            <div class="tab active" onclick="switchTab('st-materi', this)">üìö Materi</div>
            <div class="tab" onclick="switchTab('st-ulangan', this)">üìù Ulangan</div>
        </div>

        <div id="st-materi" class="content-area active">
            <div id="list-materi">Memuat materi terbaru...</div>
        </div>

        <div id="st-ulangan" class="content-area">
            <div id="list-ulangan">Memuat jadwal ulangan...</div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, where, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyCMTyiaRfzZ0eNi49M5u6C4QnfHIqVT7G4", 
            authDomain: "kelasdigital-b58ce.firebaseapp.com", 
            projectId: "kelasdigital-b58ce" 
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Fungsi Ambil Materi Realtime
        function loadMateri() {
            const jenjang = document.getElementById('filter-jenjang').value;
            const q = query(collection(db, "materi"), where("jenjang", "==", jenjang), orderBy("createdAt", "desc"));
            
            onSnapshot(q, (snapshot) => {
                let html = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    html += `
                        <div class="materi-card">
                            <h3>${data.judul}</h3>
                            <p>${data.isi}</p>
                            <div class="meta">Diposting: ${data.createdAt?.toDate().toLocaleString() || 'Baru saja'}</div>
                        </div>`;
                });
                document.getElementById('list-materi').innerHTML = html || '<p>Belum ada materi untuk jenjang ini.</p>';
            });
        }

        document.getElementById('filter-jenjang').addEventListener('change', loadMateri);
        loadMateri(); // Jalankan saat pertama buka
    </script>

    <script>
        function switchTab(id, el) {
            document.querySelectorAll('.content-area').forEach(a => a.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
        }
    </script>
</body>
</html>
